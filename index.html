<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .card { border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .habit-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; }
        .habit-item:last-child { border-bottom: none; }
        .streak-badge { background-color: #ffc107; color: #000; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="text-center mb-5">Habit Tracker</h1>
        
        <div class="row">
            <div class="col-md-4">
                <div class="card p-4">
                    <h3>Add New Habit</h3>
                    <div class="input-group mb-3">
                        <input type="text" id="habitInput" class="form-control" placeholder="Drink Water">
                        <button class="btn btn-primary" onclick="addHabit()">Add</button>
                    </div>
                </div>
                
                <div class="card p-4">
                    <h3>Daily Check-in</h3>
                    <div id="habitList"></div>
                </div>
            </div>
            
            <div class="col-md-8">
                <div class="card p-4">
                    <h3>Activity Overview</h3>
                    <canvas id="habitChart"></canvas>
                </div>
                
                <div class="card p-4">
                    <h3>History</h3>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Habit</th>
                                    <th>Current Streak</th>
                                    <th>Total Completions</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let habits = JSON.parse(localStorage.getItem('habits')) || [];

        function saveHabits() {
            localStorage.setItem('habits', JSON.stringify(habits));
            render();
        }

        function addHabit() {
            const name = document.getElementById('habitInput').value;
            if (!name) return;
            habits.push({
                name,
                completions: [],
                streak: 0
            });
            document.getElementById('habitInput').value = '';
            saveHabits();
        }

        function toggleHabit(index) {
            const today = new Date().toISOString().split('T')[0];
            const habit = habits[index];
            const dateIndex = habit.completions.indexOf(today);
            
            if (dateIndex > -1) {
                habit.completions.splice(dateIndex, 1);
            } else {
                habit.completions.push(today);
            }
            calculateStreaks();
            saveHabits();
        }

        function calculateStreaks() {
            const today = new Date();
            habits.forEach(habit => {
                let streak = 0;
                let current = new Date();
                const completionSet = new Set(habit.completions);
                
                while (completionSet.has(current.toISOString().split('T')[0])) {
                    streak++;
                    current.setDate(current.getDate() - 1);
                }
                habit.streak = streak;
            });
        }

        function render() {
            const today = new Date().toISOString().split('T')[0];
            const habitList = document.getElementById('habitList');
            const historyBody = document.getElementById('historyBody');
            
            habitList.innerHTML = '';
            historyBody.innerHTML = '';
            
            habits.forEach((habit, index) => {
                const checked = habit.completions.includes(today) ? 'checked' : '';
                habitList.innerHTML += `
                    <div class="habit-item">
                        <span>${habit.name}</span>
                        <input type="checkbox" onclick="toggleHabit(${index})" ${checked}>
                    </div>
                `;
                
                historyBody.innerHTML += `
                    <tr>
                        <td>${habit.name}</td>
                        <td><span class="badge streak-badge">${habit.streak} days</span></td>
                        <td>${habit.completions.length}</td>
                    </tr>
                `;
            });
            updateChart();
        }

        let chart;
        function updateChart() {
            const canvas = document.getElementById('habitChart');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            const labels = habits.map(h => h.name);
            const data = habits.map(h => h.completions.length);

            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Total Completions',
                        data: data,
                        backgroundColor: '#0d6efd'
                    }]
                },
                options: {
                    responsive: true,
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        render();
    </script>
</body>
</html>