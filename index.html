<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold">Habit Tracker</h1>
            <button onclick="openModal()" class="bg-blue-600 text-white px-4 py-2 rounded">Add Habit</button>
        </header>
        <div id="habitsGrid" class="grid gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 mb-8"></div>
        <div class="bg-white p-6 rounded shadow mb-8">
            <h2 class="text-xl font-bold mb-4">Streaks</h2>
            <canvas id="progressChart" height="100"></canvas>
        </div>
        <div class="bg-white p-6 rounded shadow">
            <h2 class="text-xl font-bold mb-4">History</h2>
            <div id="historyList" class="space-y-1 text-sm text-gray-600"></div>
        </div>
    </div>
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center">
        <div class="bg-white p-8 rounded w-80">
            <input id="habitName" type="text" placeholder="Habit Name" class="w-full border p-2 mb-4">
            <div class="flex justify-end gap-2">
                <button onclick="closeModal()">Cancel</button>
                <button onclick="addHabit()" class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
            </div>
        </div>
    </div>
    <script>
        let habits = JSON.parse(localStorage.getItem('habits')) || [];
        let history = JSON.parse(localStorage.getItem('habitHistory')) || [];
        function save() { 
            localStorage.setItem('habits', JSON.stringify(habits));
            localStorage.setItem('habitHistory', JSON.stringify(history));
            render();
            updateChart();
        }
        function openModal() { document.getElementById('modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('modal').style.display = 'none'; }
        function addHabit() {
            const name = document.getElementById('habitName').value;
            if (name) { 
                habits.push({ id: Date.now(), name, streak: 0, lastCheck: null });
                closeModal();
                save();
            }
        }
        function toggleHabit(id) {
            const h = habits.find(x => x.id === id);
            const today = new Date().toDateString();
            if (h.lastCheck !== today) {
                h.streak++; h.lastCheck = today;
                history.push({ name: h.name, date: today });
                save();
            }
        }
        function render() {
            const grid = document.getElementById('habitsGrid');
            grid.innerHTML = habits.map(h => {
                const isDone = h.lastCheck === new Date().toDateString();
                return '<div class="bg-white p-6 rounded shadow">' +
                    '<h3 class="font-bold">' + h.name + '</h3>' +
                    '<p class="mb-4">Streak: ' + h.streak + ' days</p>' +
                    '<button onclick="toggleHabit(' + h.id + ')" class="w-full py-2 rounded ' + (isDone ? 'bg-green-100' : 'bg-blue-100') + '">' + (isDone ? 'Done' : 'Complete') + '</button>' +
                    '</div>';
            }).join('');
            document.getElementById('historyList').innerHTML = history.slice(-10).reverse().map(i => '<div>' + i.name + ' - ' + i.date + '</div>').join('');
        }
        let chart;
        function updateChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: habits.map(h => h.name),
                    datasets: [{ label: 'Streaks', data: habits.map(h => h.streak), backgroundColor: '#3b82f6' }]
                }
            });
        }
        render(); updateChart();
    </script>
</body>
</html>